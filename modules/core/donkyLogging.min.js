/*!
 * DonkyLogging JavaScript Library
 *
 * Copyright (C) Donky Networks Ltd. All rights reserved.
 *
 */
;var DonkyLogging=(function(){var a={Fatal:0,Error:1,Warn:2,Info:3,Debug:4};var h={0:"Fatal",1:"Error",2:"Warn",3:"Info",4:"Debug"};var b;var g={logLevel:a.Debug,maxSize:1024*1,key:"rollingLogfile"};var d=null;var c=("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4);function f(m,l,i){if(m<=g.logLevel){var k="["+c+"] : "+new Date().toJSON()+" ["+h[m]+"] : "+l+(i!==undefined?(" : "+JSON.stringify(i)):"")+"\r\n";switch(m){case a.Fatal:case a.Error:console.error(k);break;case a.Warn:console.warn(k);break;default:console.log(k);break}var j=d.donkyData.getString(g.key);if(j!==null){j+=k}else{j=k}if(j.length>g.maxSize){j=j.substring(k.length)}d.donkyData.setString(g.key,j);d.publishLocalEvent({type:"LogMessage",data:{logLevel:m,message:l,args:i}})}}function e(i){if(typeof b!="undefined"){return b}if(i===undefined||i===null){throw new Error("no options specified")}if(i.donkyCore===undefined){throw new Error("No donkyCore specified")}d=i.donkyCore;b=this;return b}e.prototype._submitAutomaticErrorLog=function(){var i=d.donkyData.get("configuration");if(i!==null&&i!==undefined){if(i.configurationItems!==undefined&&i.configurationItems.AlwaysSubmitErrors=="true"){d._submitLog("AutomaticByDevice")}}};e.prototype.fatalLog=function(j,i){if(a.Fatal<=g.logLevel){f(a.Fatal,j,i);d._submitLog("AutomaticByDevice")}};e.prototype.errorLog=function(j,i){if(a.Error<=g.logLevel){f(a.Error,j,i);d._submitLog("AutomaticByDevice")}};e.prototype.warnLog=function(j,i){if(a.Warn<=g.logLevel){f(a.Warn,j,i)}};e.prototype.infoLog=function(j,i){if(a.Info<=g.logLevel){f(a.Info,j,i)}};e.prototype.debugLog=function(j,i){if(a.Debug<=g.logLevel){f(a.Debug,j,i)}};e.prototype.getLog=function(){return d.donkyData.getString(g.key)};e.prototype.clearLog=function(){return d.donkyData.remove(g.key)};e.prototype.logLevel=a;e.prototype._getLogLevel=function(){return g.logLevel};e.prototype._setLogLevel=function(i){if(i>=a.Fatal&&i<=a.Debug){g.logLevel=i}};return e})();